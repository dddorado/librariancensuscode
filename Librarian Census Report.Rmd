---
title: "Librarian Census Report"
author: "UP School of Library and Information Studies"
date: "`r Sys.Date()`"
output: 
  word_document: 
    fig_width: 8
---

The University of the Philippines School of Library and Information Studies (UPSLIS) conducted a study of Philippine Librarians from November 2018 to October 2019. This endeavor was the first-ever wide-scale study undertaken to collect the occupational profile of Librarians in the Philippines. The survey was designed to be an online questionnaire via Mentimeter and was presented for dissemination during the 2018 Philippine Librarians Association Inc. (PLAI) Congress at Novotel in Quezon City. To further disseminate, the link was posted on the UPSLIS Facebook account and was shared to library association group pages. A total of 685 responses were recorded which is only 7.5% of the almost 9000 registered librarians in the Philippines but can be used in making statistical inference with a 4% margin of error.

```{r Ingress, include=FALSE}
# Load needed package
library(tidyverse)
library(tm)
library(infer)

#Load the raw "librariancensus.csv" dataset
dataset <- read_rds("librariancensus.rds")

#controls how many digits will be printed
options(digits=4) 

#Initialize a pseudorandom number generator to obtain the same output during simulation
set.seed(12)
```

# Question: Are you currently a licensed librarian (R.A. 9246) ?

-   Yes, I have a valid and up-to-date PRC license for librarians
-   No, I have not renewed my license
-   No, I have never taken any licensure examination for librarians and/or never applied for a PRC license for librarians

```{r PRC License, echo=FALSE}
# Graph the data
dataset %>%
filter(!is.na(licensed)) %>%
ggplot(aes(x = licensed, fill = licensed)) + geom_bar() + geom_text(aes(label = ..count..), stat = "count", vjust = -0.2, colour = "black") + xlab("Distribution of responses") + ylab("Frequency") + ggtitle("Distribution of Responses: PRC License", "n=660") + guides(fill = "none") + scale_fill_viridis_d()
```

## Question: Are you currently residing in the Philippines?

-   Yes, I am currently residing and staying in the Philippines
-   No, I am in the Philippines right now but only for vacation
-   No, I am currently residing outside the Philippines

```{r Residency, echo=FALSE}
# Graph the data
dataset %>%
filter(!is.na(philippines)) %>%
ggplot(aes(x = philippines, fill = philippines)) + geom_bar() + geom_text(aes(label = ..count..), stat = "count", vjust = -0.2, colour = "black") + xlab("Distribution of responses") + ylab("Frequency") + ggtitle("Distribution of Responses: Residency", "n=658") + guides(fill = "none") + scale_fill_viridis_d()
```

## Question: Kindly indicate which gender you identify the most

-   Man
-   Woman
-   LGBTQ+
-   Prefer not to say

```{r Gender, echo=FALSE}
# Graph the data
dataset %>%
filter(!is.na(gender)) %>%
ggplot(aes(x = gender, fill = gender)) + geom_bar() + geom_text(aes(label = ..count..), stat = "count", vjust = -0.2, colour = "black") + xlab("Distribution of responses") + ylab("Frequency") + ggtitle("Distribution of Responses: Gender", "n=660") + guides(fill = "none") + scale_fill_viridis_d()
```

## Question: Kindly indicate your age

```{r Summary Age, echo=FALSE}
# Inspect the responses
summary(dataset$age)
```

```{r Age, echo=FALSE}
dataset %>%
filter(!is.na(age_group)) %>%
ggplot(aes(x = age_group, fill = age_group)) + geom_bar() + geom_text(aes(label = ..count..), stat = "count", vjust = -0.2, colour = "black") + xlab("Distribution of responses") + ylab("Frequency") + ggtitle("Distribution of Responses: Age", "n=656") + guides(fill = "none") + scale_fill_viridis_d()
```

```{r Histogram Age, echo=FALSE, warning=FALSE}
dataset %>%
filter(!is.na(age)) %>%
filter(age > 20) %>%
filter(age < 65) %>%
ggplot(aes(x = age, fill = age)) + geom_histogram(bins = 8) + xlab("Distribution of responses") + ylab("Frequency") + ggtitle("Distribution of Responses: Age", "n=647") + guides(fill = "none") + scale_fill_viridis_d()
```

```{r Boxplot Age, echo=FALSE}
# Graph the data: boxplot + violin plot + dot plot
dataset %>%
filter(!is.na(age)) %>%
filter(age > 20) %>%
filter(age < 65) %>%
ggplot(aes(x = 1, y = age)) + geom_violin(adjust=.7) + geom_boxplot(width = .1, fill = "black") + geom_dotplot(aes(y = age), binaxis = "y", binwidth = .3, stackdir = "center", alpha = .5) + stat_summary(fun = mean, geom = "point", fill = "white", shape = 21, size = 2.5) + coord_flip() + theme(axis.text.y = element_blank()) + xlab("Distribution") + ylab("Age") + ggtitle("Distribution of Responses: Age(Boxplot)", "n=647")
```

## Question: Are you currently employed and/or working?

-   Yes, I am currently employed by an institution, agency, individual or similar.
-   Yes, I am currently self-employed and/or doing freelance and consultancy work.
-   No, I am currently not working for reasons other than retirement.
-   No, I am a retiree.

```{r Currently Working, echo=FALSE}
# Graph the data
dataset %>%
filter(!is.na(working)) %>%
ggplot(aes(x = working, fill = working)) + geom_bar() + geom_text(aes(label = ..count..), stat = "count", vjust = -0.2, colour = "black") + xlab("Distribution of responses") + ylab("Frequency") + ggtitle("Distribution of Responses: Currently Working", "n=658") + guides(fill = "none") + scale_fill_viridis_d()
```

## Question: Kindly indicate the setting, field or industry you are primarily working in

-   library
-   archives and/or records management
-   academic institution (non-librarian position)
-   information technology, computer science, software / database engineering and other similar line of work
-   museum and heritage work
-   social services

```{r Industry, echo=FALSE}
# Graph the data
dataset %>%
filter(!is.na(industry)) %>%
ggplot(aes(x = industry, fill = industry)) + geom_bar() + geom_text(aes(label = ..count..), stat = "count", vjust = -0.2, colour = "black") + xlab("Distribution of responses") + ylab("Frequency") + ggtitle("Distribution of Responses: Industry", "n=652") + guides(fill = "none") + scale_fill_viridis_d()
```

## Question: How long have you been working as a professional after passing the licensure exam for librarians (cumulative years)

```{r Summary Years of Service, echo=FALSE}
# Inspect the responses
summary(dataset$years_service)
```

```{r Years of Service, echo=FALSE}
# Graph the data: bar graph
dataset %>%
filter(!is.na(years_service_group)) %>%
ggplot(aes(x = years_service_group, fill = years_service_group)) + geom_bar() + geom_text(aes(label = ..count..), stat = "count", vjust = -0.2, colour = "black") + xlab("Distribution of responses") + ylab("Frequency") + ggtitle("Distribution of Responses: Years of Service", "n=649") + guides(fill = "none") + scale_fill_viridis_d()
```

```{r Histogram Years of Service, echo=FALSE}
# Graph the data: histogram
dataset %>%
filter(!is.na(years_service)) %>%
filter(years_service < 35) %>%
ggplot(aes(x = years_service, fill = years_service)) + geom_histogram(bins = 8) + xlab("Distribution of responses") + ylab("Frequency") + ggtitle("Distribution of Responses: Years of Service", "n=649") + guides(fill = "none") + scale_fill_viridis_d()
```

```{r Boxplot Years of Service, echo=FALSE}
# Graph the data: boxplot + violin plot + dot plot
dataset %>%
filter(!is.na(years_service)) %>%
filter(years_service < 35) %>%
ggplot(aes(x = 1, y = years_service)) + geom_violin(adjust=.8) + geom_boxplot(width = .1, fill = "black") + geom_dotplot(aes(y = years_service), binaxis = "y", binwidth = .13, stackdir = "center", alpha = .5) + stat_summary(fun = mean, geom = "point", fill = "white", shape = 21, size = 2.5) + coord_flip() + theme(axis.text.y = element_blank()) + xlab("Distribution") + ylab("Years of Service") + ggtitle("Distribution of Responses: Years of Service(Boxplot)", "n=649")
```

## Question: Kindly indicate the type of institution (in terms of ownership) you are primarily working in

-   government
-   private (in-house)
-   private (BPO)
-   non-profit

```{r Institution, echo=FALSE}
# Graph the data
dataset %>%
filter(!is.na(institution)) %>%
ggplot(aes(x = institution, fill = institution)) + geom_bar() + geom_text(aes(label = ..count..), stat = "count", vjust = -0.2, colour = "black") + xlab("Distribution of responses") + ylab("Frequency") + ggtitle("Distribution of Responses: Institution", "n=644") + guides(fill = "none") + scale_fill_viridis_d()
```

## Question: Kindly indicate your current tenure status

-   permanent
-   contractual
-   voluntary work
-   job order (J.O.)
-   self-employed, freelancing or working with multiple institutions

```{r Tenure, echo=FALSE}
# Graph the data
dataset %>%
filter(!is.na(tenure)) %>%
ggplot(aes(x = tenure, fill = tenure)) + geom_bar() + geom_text(aes(label = ..count..), stat = "count", vjust = -0.2, colour = "black") + xlab("Distribution of responses") + ylab("Frequency") + ggtitle("Distribution of Responses: Tenure", "n=640") + guides(fill = "none") + scale_fill_viridis_d()
```

## Question: Kindly indicate your current monthly gross salary or income range (before deductions)

```{r Summary Gross Salary, echo=FALSE}
# Inspect the responses
summary(dataset$gross_salary)
```


```{r Gross Salary, echo=FALSE}
# Graph the data: bar graph
dataset %>% 
filter(!is.na(gross_salary_group)) %>%
ggplot(aes(x = gross_salary_group, fill = gross_salary_group)) + geom_bar() + geom_text(aes(label = ..count..), stat = "count", vjust = -0.2, colour = "black") + xlab("Distribution of responses") + ylab("Frequency") + ggtitle("Distribution of Responses: Gross Salary", "n=563") + guides(fill = "none") + scale_fill_viridis_d()
```

```{r Histogram Gross Salary, echo=FALSE}
# Graph the data: histogram
dataset %>%
filter(!is.na(gross_salary)) %>%
filter(gross_salary > 10) %>%
filter(gross_salary < 65) %>%
ggplot(aes(x = gross_salary, fill = gross_salary)) + geom_histogram(bins = 10) + xlab("Distribution of responses") + ylab("Frequency") + ggtitle("Distribution of Responses: Gross Salary", "n=509") + guides(fill = "none") + scale_fill_viridis_d()
```

```{r Boxplot Gross Salary, echo=FALSE}
# Graph the data: boxplot + violin plot + dot plot
dataset %>%
filter(!is.na(gross_salary)) %>%
filter(gross_salary > 10) %>%
filter(gross_salary < 65) %>%
ggplot(aes(x = 1, y = gross_salary)) + geom_violin(adjust=2) + geom_boxplot(width = .1, fill = "black") + geom_dotplot(aes(y = gross_salary), binaxis = "y", binwidth = .3, stackdir = "center", alpha = .5) + stat_summary(fun = mean, geom = "point", fill = "white", shape = 21, size = 2.5) + coord_flip() + theme(axis.text.y = element_blank()) + xlab("Distribution") + ylab("Gross Salary") + ggtitle("Distribution of Responses: Gross Salary(Boxplot)", "n=509")
```

## Kindly indicate your current monthly net salary or income range (after deductions)

```{r Summary Net Salary, echo=FALSE}
# Inspect the responses
summary(dataset$net_salary)
```


```{r Net Salary, echo=FALSE}
# Graph the data: bar graph
dataset %>%
filter(!is.na(net_salary_group)) %>%
ggplot(aes(x = net_salary_group, fill = net_salary_group)) + geom_bar() + geom_text(aes(label = ..count..), stat = "count", vjust = -0.2, colour = "black") + xlab("Distribution of responses") + ylab("Frequency") + ggtitle("Distribution of Responses: Net Salary", "n=551") + guides(fill = "none") + scale_fill_viridis_d()
```

```{r Histogram Net Salary, echo=FALSE}
# Graph the data: bar graph
dataset %>%
filter(!is.na(net_salary)) %>%
filter(net_salary > 10) %>%
filter(net_salary < 65) %>%
ggplot(aes(x = net_salary, fill = net_salary)) + geom_histogram(bins = 10) + xlab("Distribution of responses") + ylab("Frequency") + ggtitle("Distribution of Responses: Net Salary", "n=447") + guides(fill = "none") + scale_fill_viridis_d()
```

```{r Boxplot Net Salary, echo=FALSE}
# Graph the data: boxplot + violin plot + dot plot
dataset %>%
filter(!is.na(net_salary)) %>%
filter(net_salary > 10) %>%
filter(net_salary < 65) %>%
ggplot(aes(x = 1, y = net_salary)) + geom_violin(adjust=2) + geom_boxplot(width = .1, fill = "black") + geom_dotplot(aes(y = net_salary), binaxis = "y", binwidth = .3, stackdir = "center", alpha = .5) + stat_summary(fun = mean, geom = "point", fill = "white", shape = 21, size = 2.5) + coord_flip() + theme(axis.text.y = element_blank()) + xlab("Distribution") + ylab("Net Salary") + ggtitle("Distribution of Responses: Net Salary(Boxplot)", "n=447")
```

## Question: Kindly indicate additional benefits, if any (please check all that apply)

-   free shuttle service
-   night differential pay
-   paid vacation and/or sick leaves
-   health card and/or insurance other than PhilHealth
-   monetary allowances
-   NONE / Not Applicable

```{r Benefits, echo=FALSE}
# Summarize by counting the TRUE values per benefits
dataset %>%
summarise("Shuttle service" = sum(shuttle == TRUE), "Night differential" = sum(night_differential == TRUE), "Paid leaves" = sum(paid_leaves == TRUE), "HMO" = sum(hmo == TRUE), "Allowances" = sum(allowances == TRUE), "No benefits" = sum(no_benefits == TRUE)) %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) + geom_col(position = "dodge") + xlab("Distribution of responses") + ylab("Frequency") + ggtitle("Distribution of Responses: Benefits", "n=631") + guides(fill = "none") + scale_fill_viridis_d() + theme(axis.text.x = element_text(angle = 90)) +
geom_text(x = 1, y = 254, label = "244", colour = "black", size = 4) + 
geom_text(x = 2, y = 269, label = "259", family = "serif", colour = "black", size = 4) +
geom_text(x = 3, y = 38, label = "28", family = "serif", colour = "black", size = 4) +
geom_text(x = 4, y = 124, label = "114", family = "serif", colour = "black", size = 4) +
geom_text(x = 5, y = 463, label = "453", family = "serif", colour = "black", size = 4) +
geom_text(x = 6, y = 46, label = "36", family = "serif", colour = "black", size = 4)
```

```{r Aggregate Benefits, echo=FALSE}
# Graph the data
dataset %>%
filter(!is.na(benefits6)) %>%
ggplot(aes(x = benefits6, fill = benefits6)) + geom_bar() + geom_text(aes(label = ..count..), stat = "count", vjust = -0.2, colour = "black") + xlab("Distribution of responses") + ylab("Frequency") + ggtitle("Distribution of Responses: Benefits", "n=631") + guides(fill = "none") + scale_fill_viridis_d()
```

## Question: Other benefits not mentioned in the previous page

```{r Other Benefits, echo=FALSE}
# Create a clean_corpus function 
clean_corpus <- function(corpus) {
    corpus <- tm_map(corpus, removePunctuation)
    corpus <- tm_map(corpus, removeNumbers)
    corpus <- tm_map(corpus, content_transformer(tolower))
    corpus <- tm_map(corpus, removeWords, c(stopwords("en")))
    corpus <- tm_map(corpus, stripWhitespace)
    return(corpus)
}
# Create a text dataset
benefits.text <- paste(dataset$otherbenefits1, dataset$otherbenefits2, dataset$otherbenefits3, dataset$otherbenefits4)
# Create a text corpus
benefit.corpus <- benefits.text %>%
VectorSource() %>%
VCorpus()
# Clean the created corpus
benefit.corpus <- clean_corpus(benefit.corpus)
# Create a dendogram
benefit.corpus %>%
TermDocumentMatrix() %>%
removeSparseTerms(sparse = 0.98) %>%
as.matrix() %>%
dist() %>%
hclust() %>%
plot()
```

## Question: What kind of materials are you currently working with? Kindly check all that applies.

-   hardcopy theses and dissertations
-   hardcopy books / pamphlets / etc
-   electronic material (digital titles, digital archives, etc)
-   law materials and resources
-   archives (physical)
-   data sets
-   institutional files and records
-   NA

```{r Materials, echo=FALSE}
# Summarize by counting the TRUE values per materials
dataset %>%
summarise("These" = sum(theses == TRUE), "Books" = sum(books == TRUE), "Electronic Materials" = sum( electronic_materials == TRUE), "Law Materials" = sum(law_materials == TRUE), "Datasets" = sum(datasets == TRUE), "Archives" = sum(archives == TRUE), "Institutional Materials" = sum(institutional_files == TRUE)) %>%
gather() %>%
ggplot(aes(x = key, y= value, fill = key)) + geom_col(position = "dodge") + xlab("Distribution of responses") + ylab("Frequency") + ggtitle("Distribution of Responses: Materials", "n=543") + guides(fill = "none") + scale_fill_viridis_d() + theme(axis.text.x = element_text(angle = 90)) +
geom_text(x = 1, y = 298, label = "288", colour = "black", size = 4) + 
geom_text(x = 2, y = 459, label = "449", colour = "black", size = 4) + 
geom_text(x = 3, y = 66, label = "56", colour = "black", size = 4) +
geom_text(x = 4, y = 273, label = "263", colour = "black", size = 4) +
geom_text(x = 5, y = 233, label = "223", colour = "black", size = 4) +
geom_text(x = 6, y = 75, label = "65", colour = "black", size = 4) +
geom_text(x = 7, y = 304, label = "294", colour = "black", size = 4)
```

## Question: Kindly indicate your current work position

-   entry level / junior staff
-   regular / senior staff (non-supervisory)
-   supervisory / mid-management level
-   upper management level / top tier executive
-   consultant / freelancer / self-employed

```{r Position, echo=FALSE}
# Graph the data
dataset %>%
filter(!is.na(position)) %>%
ggplot(aes(x = position, fill = position)) + geom_bar() + geom_text(aes(label = ..count..), stat = "count", vjust = -0.2, colour = "black") + xlab("Distribution of responses") + ylab("Frequency") + ggtitle("Distribution of Responses: Position", "n=579") + guides(fill = "none") + scale_fill_viridis_d()
```

## Question: Within the next five (5) years, do you see your self working in the same industry?

-   Yes
-   No (planning to shift to other fields or industry)
-   Maybe / Undecided

```{r 5-year plan, echo=FALSE}
# Graph the data
dataset %>%
filter(!is.na(fiveyears)) %>%
ggplot(aes(x = fiveyears, fill = fiveyears)) + geom_bar() + geom_text(aes(label = ..count..), stat = "count", vjust = -0.2, colour = "black") + xlab("Distribution of responses") + ylab("Frequency") + ggtitle("Distribution of Responses: 5-year plan", "n=586") + guides(fill = "none") + scale_fill_viridis_d()
```

## Question: If your answer was NO or MAYBE in the previous page, indicate the field you wish to pursue

```{r Field to pursue, echo=FALSE}
# Create a clean_corpus function 
clean_corpus <- function(corpus) {
    corpus <- tm_map(corpus, removePunctuation)
    corpus <- tm_map(corpus, removeNumbers)
    corpus <- tm_map(corpus, content_transformer(tolower))
    corpus <- tm_map(corpus, removeWords, c(stopwords("en"), "none", "yes", "like", "library", "librarianship", "want", "work"))
    corpus <- tm_map(corpus, stripWhitespace)
    return(corpus)
}
# Create a text corpus
fiveyearplan.corpus <- dataset$pursue %>%
VectorSource() %>%
VCorpus()
# Clean the created corpus
fiveyearplan.corpus <- clean_corpus(fiveyearplan.corpus)
# Create a dendogram
fiveyearplan.corpus %>%
TermDocumentMatrix() %>%
removeSparseTerms(sparse = 0.995) %>%
as.matrix() %>%
dist() %>%
hclust() %>%
plot()
```

## Question: Kindly indicate your highest educational attainment

-   High School
-   Bachelor's degree (BLIS)
-   Bachelor's degree (non-BLIS)
-   Master's degree (MLIS)
-   Master's degree (non-MLIS)
-   Juris Doctor / Bachelor of Laws
-   Doctor of Philosophy (Ph.D)

```{r Highest Educational Attainment, echo=FALSE}
# Graph the data
dataset %>%
filter(!is.na(education)) %>%
ggplot(aes(x = education, fill = education)) + geom_bar() + geom_text(aes(label = ..count..), stat = "count", vjust = -0.2, colour = "black") + xlab("Distribution of responses") + ylab("Frequency") + ggtitle("Distribution of Responses: Highest Educational Attainment", "n=581") + guides(fill = "none") + scale_fill_viridis_d()
```

## Question: Are you currently enrolled in formal studies? (Short Courses, Certificate Program, Diploma Program, Master Program, PhD)

-   Yes
-   No

```{r Currently Enroled, echo=FALSE}
# Graph the data
dataset %>%
filter(!is.na(enrolled)) %>%
ggplot(aes(x = enrolled, fill = enrolled)) + geom_bar() + geom_text(aes(label = ..count..), stat = "count", vjust = -0.2, colour = "black") + xlab("Distribution of responses") + ylab("Frequency") + ggtitle("Distribution of Responses: Currently Enroled", "n=580") + guides(fill = "none") + scale_fill_viridis_d()
```

## Question: If your answer was YES, indicate the degree you are currently completing

-   Short \| Certificate \| Diploma Program
-   Bachelor's degree (BLIS)
-   Master's degree (MLIS)
-   Master's degree (non-MLIS)
-   Juris Doctor / Bachelor of Laws
-   Doctor of Philosophy (Ph.D)
-   Post-graduate Certificate or Diploma (LIS)
-   Post-graduate Certificate or Diploma (non-LIS)

```{r Current Enrollment, echo=FALSE}
# Graph the data
dataset %>%
filter(!is.na(completing)) %>%
ggplot(aes(x = completing, fill = completing)) + geom_bar() + geom_text(aes(label = ..count..), stat = "count", vjust = -0.2, colour = "black") + xlab("Distribution of responses") + ylab("Frequency") + ggtitle("Distribution of Responses: Current Enrollment", "n=287") + guides(fill = "none") + theme(axis.text.x = element_text(angle = 90)) + scale_fill_viridis_d()
```

## Question: Are you planning to study again in a formal university setting within the next five (5) years?

-   Yes
-   No
-   Maybe

```{r Study Again, echo=FALSE}
# Graph the data
dataset %>%
filter(!is.na(study_again)) %>%
ggplot(aes(x = study_again, fill = study_again)) + geom_bar() + geom_text(aes(label = ..count..), stat = "count", vjust = -0.2, colour = "black") + xlab("Distribution of responses") + ylab("Frequency") + ggtitle("Distribution of Responses: Current Enrollment", "n=574") + guides(fill = "none") + scale_fill_viridis_d()
```

## Question: If your answer was YES, kindly provide the degree you wish to study within the next five (5) years

-   Short \| Certificate \| Diploma Program
-   Bachelor's degree (BLIS)
-   Master's degree (MLIS)
-   Master's degree (non-MLIS)
-   Juris Doctor / Bachelor of Laws
-   Doctor of Philosophy (Ph.D)
-   Post-graduate Certificate or Diploma (LIS)
-   Post-graduate Certificate or Diploma (non-LIS)

```{r after5years, echo=FALSE}
# Graph the data
dataset %>%
filter(!is.na(after5years)) %>%
ggplot(aes(x = after5years, fill = after5years)) + geom_bar() + geom_text(aes(label = ..count..), stat = "count", vjust = -0.2, colour = "black") + xlab("Distribution of responses") + ylab("Frequency") + ggtitle("Distribution of Responses: Plan within 5 years", "n=431") + guides(fill = "none") + theme(axis.text.x = element_text(angle = 90)) + scale_fill_viridis_d()
```

## Question: Where do you usually acquire your CPD trainings in LIS? Kindly check all that applies

-   within the work place (in-house trainings)
-   government facilitated trainings and symposiums
-   trainings and symposiums facilitated by private entities, individuals and/or corporations
-   NA (Have not attended CPD Trainings yet)

```{r CPD Training, echo=FALSE}
# Summarize by counting the TRUE values per materials
dataset %>%
summarise("in-house trainings" = sum(inhouse == TRUE), "government facilitated" = sum(government == TRUE), "private entities" = sum(private == TRUE), "Have not attended CPD Trainings" = sum(xattended == TRUE)) %>%
gather() %>%
ggplot(aes(x = key, y= value, fill = key)) + geom_col(position = "dodge") + xlab("Distribution of responses") + ylab("Frequency") + ggtitle("Distribution of Responses: CPD Training", "n=563") + guides(fill = "none") + scale_fill_viridis_d() + theme(axis.text.x = element_text(angle = 90)) +
geom_text(x = 1, y = 199, label = "189", colour = "black", size = 4) + 
geom_text(x = 2, y = 103, label = "93", colour = "black", size = 4) + 
geom_text(x = 3, y = 168, label = "158", colour = "black", size = 4) +
geom_text(x = 4, y = 434, label = "424", colour = "black", size = 4)
```

## Where do you usually get funding or support for your trainings in LIS?

-   from the work place (private sponsorship)
-   from the government (scholarships, free trainings and seminars, etc)
-   personal funding (personally attended trainings and symposiums and shouldered most of the expenses)
-   NA (Have not attended CPD Trainings yet)

```{r CPD Support, echo=FALSE}
# Summarize by counting the TRUE values per materials
dataset %>%
summarise("personal funding" = sum(support_self == TRUE), "government facilitated" = sum(support_government == TRUE), "private entities" = sum(support_private == TRUE), "Have not attended CPD Trainings" = sum(support_xattended == TRUE)) %>%
gather() %>%
ggplot(aes(x = key, y= value, fill = key)) + geom_col(position = "dodge") + xlab("Distribution of responses") + ylab("Frequency") + ggtitle("Distribution of Responses: CPD Support", "n=563") + guides(fill = "none") + scale_fill_viridis_d() + theme(axis.text.x = element_text(angle = 90)) +
geom_text(x = 1, y = 162, label = "152", colour = "black", size = 4) +
geom_text(x = 2, y = 372, label = "362", colour = "black", size = 4) +
geom_text(x = 3, y = 300, label = "290", colour = "black", size = 4) +
geom_text(x = 4, y = 264, label = "254", colour = "black", size = 4)
```

## Question: Are you satisfied with the amount of CPD trainings you have attended for the last two (2) years?

-   Yes, the amount of trainings I received within the last two (2) years is enough.
-   No, the amount of trainings I received within the last two (2) years is not enough.
-   No, the amount of trainings received within the last two (2) years is too much.
-   Maybe
-   NA (Have not attended CPD Trainings yet)

```{r CPD Satisfaction, echo=FALSE}
# Graph the data
dataset %>%
filter(!is.na(cpdsatisfaction)) %>%
ggplot(aes(x = cpdsatisfaction, fill = cpdsatisfaction)) + geom_bar() + geom_text(aes(label = ..count..), stat = "count", vjust = -0.2, colour = "black") + xlab("Distribution of responses") + ylab("Frequency") + ggtitle("Distribution of Responses: CPD Satisfaction", "n=563") + guides(fill = "none") + theme(axis.text.x = element_text(angle = 90)) + scale_fill_viridis_d()
```

## Question: Kindly indicate any challenges you encounter when fulfilling the required CPD trainings

```{r CPD Challenges, echo=FALSE}
# Create a clean_corpus function 
clean_corpus <- function(corpus) {
    corpus <- tm_map(corpus, removePunctuation)
    corpus <- tm_map(corpus, removeNumbers)
    corpus <- tm_map(corpus, content_transformer(tolower))
    corpus <- tm_map(corpus, removeWords, c(stopwords("en")))
    corpus <- tm_map(corpus, stripWhitespace)
    return(corpus)
}
# Create a text dataset
cpdbarriers.text <- paste(dataset$cpdbarriers1, dataset$cpdbarriers2, dataset$cpdbarriers3)
# Create a text corpus
cpdbarriers.corpus <- cpdbarriers.text %>%
VectorSource() %>%
VCorpus()
# Clean the created corpus
cpdbarriers.corpus <- clean_corpus(cpdbarriers.corpus)
# Create a dendogram
cpdbarriers.corpus %>%
TermDocumentMatrix() %>%
removeSparseTerms(sparse = 0.98) %>%
as.matrix() %>%
dist() %>%
hclust() %>%
plot()
```

## Kindly indicate any topics you wish to explore in future trainings

```{r training topics, echo=FALSE}
# Create a clean_corpus function 
clean_corpus <- function(corpus) {
    corpus <- tm_map(corpus, removePunctuation)
    corpus <- tm_map(corpus, removeNumbers)
    corpus <- tm_map(corpus, content_transformer(tolower))
    corpus <- tm_map(corpus, removeWords, c(stopwords("en"), "library", "librarianship"))
    corpus <- tm_map(corpus, stripWhitespace)
    return(corpus)
}
# Create a text dataset
topics.text <- paste(dataset$topics1, dataset$topics2, dataset$topics3, dataset$topics4, dataset$topics5)
# Create a text corpus
topics.corpus <- topics.text %>%
VectorSource() %>%
VCorpus()
# Clean the created corpus
topics.corpus <- clean_corpus(topics.corpus)
# Create a dendogram
topics.corpus %>%
TermDocumentMatrix() %>%
removeSparseTerms(sparse = 0.985) %>%
as.matrix() %>%
dist() %>%
hclust() %>%
plot()
```

## Kindly indicate your primary work location

-   NCR
-   Region I
-   Region II
-   CAR
-   Region III
-   Region IV
-   Region V
-   Region VI
-   Region VII
-   Region VIII
-   Region IX
-   Region X
-   Region XI
-   Region XII
-   CARAGA
-   ARMM

```{r Location, echo=FALSE}
# Graph the data
dataset %>%
filter(!is.na(location)) %>%
ggplot(aes(x = location, fill = location)) + geom_bar() + geom_text(aes(label = ..count..), stat = "count", vjust = -0.2, colour = "black") + xlab("Distribution of responses") + ylab("Frequency") + ggtitle("Distribution of Responses: Location", "n=538") + guides(fill = "none") + theme(axis.text.x = element_text(angle = 90)) + scale_fill_viridis_d()
```

```{r LVM, echo=FALSE}
# Graph the data
dataset %>%
filter(!is.na(lvm)) %>%
ggplot(aes(x = lvm, fill = lvm)) + geom_bar() + geom_text(aes(label = ..count..), stat = "count", vjust = -0.2, colour = "black") + xlab("Distribution of responses") + ylab("Frequency") + ggtitle("Distribution of Responses: Location", "n=538") + guides(fill = "none") + theme(axis.text.x = element_text(angle = 90)) + scale_fill_viridis_d()
```

## Question: Have you moved out of your original / permanent residence in order to work on your current work place?

-   Yes
-   No

```{r Work Travel, echo=FALSE}                                    
# Graph the data
dataset %>%
filter(!is.na(worktravel)) %>%
ggplot(aes(x = worktravel, fill = worktravel)) + geom_bar() + geom_text(aes(label = ..count..), stat = "count", vjust = -0.2, colour = "black") + xlab("Distribution of responses") + ylab("Frequency") + guides(fill = "none") + ggtitle("Distribution of Responses: Work Travel", "n=566") + scale_fill_viridis_d()
```

## Is Filipino / Tagalog your native language?

-   Yes
-   No

```{r Filipino as First Language, echo=FALSE}
# Graph the data
dataset %>%
filter(!is.na(filipino)) %>%
ggplot(aes(x = filipino, fill = filipino)) + geom_bar() + geom_text(aes(label = ..count..), stat = "count", vjust = -0.2, colour = "black") + xlab("Distribution of responses") + ylab("Frequency") + guides(fill = "none") + ggtitle("Distribution of Responses: Filipino as First Language", "n=551") + scale_fill_viridis_d()
```

## Kindly check the local languages or dialects you can speak on a conversational level other than Filipino / Tagalog

-   Ilocano
-   Cebuano
-   Ilonggo
-   Kapampangan
-   Pangasinense
-   Waray
-   Bicolano
-   Others

```{r Dialect, echo=FALSE}
dataset %>%
filter(!is.na(dialect)) %>%
ggplot(aes(x = dialect, fill = dialect)) + geom_bar() + geom_text(aes(label = ..count..), stat = "count", vjust = -0.2, colour = "black") + xlab("Distribution of responses") + ylab("Frequency") + guides(fill = "none") + ggtitle("Distribution of Responses: Dialect", "n=392") + scale_fill_viridis_d()
```

## Kindly indicate any foreign languages or dialects you can speak on a conversational level other than English (if any)

```{r other dialect, echo=FALSE}
# Create a clean_corpus function 
clean_corpus <- function(corpus) {
    corpus <- tm_map(corpus, removePunctuation)
    corpus <- tm_map(corpus, removeNumbers)
    corpus <- tm_map(corpus, content_transformer(tolower))
    corpus <- tm_map(corpus, removeWords, c(stopwords("en"), "none", "can", "kankanaey", "tagalog", "filipino", "english"))
    corpus <- tm_map(corpus, stripWhitespace)
    return(corpus)
}
# Create a text corpus
topics.corpus <- dataset$foreignlang %>%
VectorSource() %>%
VCorpus()
# Clean the created corpus
topics.corpus <- clean_corpus(topics.corpus)
# Create a wordcount
term.frequency <- topics.corpus %>%
TermDocumentMatrix() %>%
as.matrix() %>%
rowSums() %>%
sort( , decreasing=TRUE)
term.frequency[1:10]
```

## Kindly indicate the type of library you are currently working in

```{r Library Type, echo=FALSE}
# Graph the data
dataset %>%
filter(!is.na(type)) %>%
ggplot(aes(x = type, fill = type)) + geom_bar() + geom_text(aes(label = ..count..), stat = "count", vjust = -0.2, colour = "black") + xlab("Distribution of responses") + ylab("Frequency") + guides(fill = "none") + ggtitle("Distribution of Responses: Library Type", "n=474") + scale_fill_viridis_d()
```

## Other than being a librarian, what other roles do you serve in your institution/ organization?

```{r Other roles, echo=FALSE}
# Create a clean_corpus function 
clean_corpus <- function(corpus) {
    corpus <- tm_map(corpus, removePunctuation)
    corpus <- tm_map(corpus, removeNumbers)
    corpus <- tm_map(corpus, content_transformer(tolower))
    corpus <- tm_map(corpus, removeWords, c(stopwords("en"), "library", "librarianship", "none", "librarian"))
    corpus <- tm_map(corpus, stripWhitespace)
    return(corpus)
}
# Create a text corpus
roles.corpus <- dataset$roles %>%
VectorSource() %>%
VCorpus()
# Clean the created corpus
roles.corpus <- clean_corpus(roles.corpus)
# Create a dendogram
roles.corpus %>%
TermDocumentMatrix() %>%
removeSparseTerms(sparse = 0.99) %>%
as.matrix() %>%
dist() %>%
hclust() %>%
plot()
```

## Kindly indicate your current work position

```{r Work position, echo=FALSE}
# Create a clean_corpus function 
clean_corpus <- function(corpus) {
    corpus <- tm_map(corpus, removePunctuation)
    corpus <- tm_map(corpus, removeNumbers)
    corpus <- tm_map(corpus, content_transformer(tolower))
    corpus <- tm_map(corpus, removeWords, c(stopwords("en"),"iii", "library", "librarianship", "none", "librarian", "sole", "librarians"))
    corpus <- tm_map(corpus, stripWhitespace)
    return(corpus)
}
# Create a text corpus
institutionposition.corpus <- dataset$institutionposition %>%
VectorSource() %>%
VCorpus()
# Clean the created corpus
institutionposition.corpus <- clean_corpus(institutionposition.corpus)
# Create a dendogram
institutionposition.corpus %>%
TermDocumentMatrix() %>%
removeSparseTerms(sparse = 0.99) %>%
as.matrix() %>%
dist() %>%
hclust() %>%
plot()
```

## Kindly indicate your primary job / designation inside the library

```{r designation, echo=FALSE}
# Create a clean_corpus function 
clean_corpus <- function(corpus) {
    corpus <- tm_map(corpus, removePunctuation)
    corpus <- tm_map(corpus, removeNumbers)
    corpus <- tm_map(corpus, content_transformer(tolower))
    corpus <- tm_map(corpus, removeWords, c(stopwords("en"),"iii", "library", "librarianship", "none", "librarian", "sole", "librarians"))
    corpus <- tm_map(corpus, stripWhitespace)
    return(corpus)
}
# Create a text corpus
primaryjob.corpus <- dataset$primaryjob %>%
VectorSource() %>%
VCorpus()
# Clean the created corpus
primaryjob.corpus <- clean_corpus(primaryjob.corpus)
# Create a dendogram
primaryjob.corpus %>%
TermDocumentMatrix() %>%
removeSparseTerms(sparse = 0.99) %>%
as.matrix() %>%
dist() %>%
hclust() %>%
plot()
```

## Kindly indicate your current / existing professional affiliations

```{r affiliation, echo=FALSE}
dataset %>%
summarise("PAARL" = sum(PAARL == TRUE), 
          "PASLI" = sum(PASLI == TRUE), 
          "ASLP" = sum(ASLP == TRUE), 
          "MAHLAP" = sum(MAHLAP == TRUE), 
          "ALAP" = sum(ALAP == TRUE), 
          "ALPS" = sum(ALPS == TRUE), 
          "PGLL" = sum(PGLL == TRUE), 
          "SFA" = sum(SFA == TRUE)) %>%
gather() %>%
ggplot(aes(x = key, y= value, fill = key)) + geom_col(position = "dodge") + xlab("Distribution of responses") + ylab("Frequency") + ggtitle("Distribution of Responses: Materials", "n=196") + guides(fill = "none") + scale_fill_viridis_d() + theme(axis.text.x = element_text(angle = 90)) +
geom_text(x = 1, y = 10, label = "7", colour = "black", size = 4) + 
geom_text(x = 2, y = 9, label = "6", colour = "black", size = 4) + 
geom_text(x = 3, y = 25, label = "23", colour = "black", size = 4) + 
geom_text(x = 4, y = 21, label = "18", colour = "black", size = 4) + 
geom_text(x = 5, y = 131, label = "128", colour = "black", size = 4) + 
geom_text(x = 6, y = 40, label = "37", colour = "black", size = 4) + 
geom_text(x = 7, y = 9, label = "6", colour = "black", size = 4) + 
geom_text(x = 8, y = 14, label = "11", colour = "black", size = 4) 
```

## Kindly indicate what factors influence your decision when it comes to joining a professional organization?

```{r Factor Joining Organizations, echo=FALSE}
# Create a clean_corpus function 
clean_corpus <- function(corpus) {
    corpus <- tm_map(corpus, removePunctuation)
    corpus <- tm_map(corpus, removeNumbers)
    corpus <- tm_map(corpus, content_transformer(tolower))
    corpus <- tm_map(corpus, removeWords, c(stopwords("en")))
    corpus <- tm_map(corpus, stripWhitespace)
    return(corpus)
}
# Create a text corpus
factor.corpus <- dataset$factor %>%
VectorSource() %>%
VCorpus()
# Clean the created corpus
factor.corpus <- clean_corpus(factor.corpus)
# Create a dendogram
factor.corpus %>%
TermDocumentMatrix() %>%
removeSparseTerms(sparse = 0.985) %>%
as.matrix() %>%
dist() %>%
hclust() %>%
plot()
```
@Dorado2022


